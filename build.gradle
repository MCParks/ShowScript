/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'

    // git commit hash in version
    id 'com.palantir.git-version' version "0.12.3"

    id "com.github.johnrengelman.shadow" version "8.0.0"
}

shadowJar {
    relocate 'cloud.commandframework', 'us.mcparks.showscript.cloud.commandframework'
}

sourceSets {
    main {
        java {
            srcDirs "src"
        }
        resources {
            srcDirs "res"
        }
    }
}

processResources {
    filesMatching('**/plugin.yml') {
        filter {
            it.replace('@version@', version)
        }
    }
}

repositories {
    mavenLocal()

     maven {
         url = uri('https://repo.maven.apache.org/maven2/')
     }

    // worldguard
    maven {
        url = uri('https://maven.enginehub.org/repo/')
    }

    // spigot
    maven {
        url = uri('https://hub.spigotmc.org/nexus/content/repositories/snapshots/')
    }

}

dependencies {
    compileOnly 'com.google.guava:guava:21.0'
    compileOnly 'org.spigotmc:spigot-api:1.12-R0.1-SNAPSHOT'
    compileOnly 'org.bukkit:bukkit:1.12-R0.1-SNAPSHOT'
    compileOnly 'com.sk89q.worldedit:worldedit-bukkit:6.1.4-SNAPSHOT'
    compileOnly 'com.sk89q.worldguard:worldguard-legacy:6.2'
    implementation 'org.codehaus.groovy:groovy-all:3.0.12'
    implementation 'cloud.commandframework:cloud-paper:1.8.3'
    implementation 'cloud.commandframework:cloud-annotations:1.8.3'
    implementation 'cloud.commandframework:cloud-minecraft-extras:1.8.3'
    implementation "net.kyori:adventure-platform-bukkit:4.3.0"
    implementation "commons-io:commons-io:2.16.1"

}

group = 'us.mcparks'
version = '1.12-1-' + gitVersion()
description = 'ShowScript'
java.sourceCompatibility = JavaVersion.VERSION_1_8
archivesBaseName = 'ShowScript'
shadowJar.archiveFileName = "ShowScript.jar"
build.dependsOn(shadowJar)
jar.enabled = false

publishing {
    publications {
        gpr(MavenPublication) {
            from components.java
            artifact shadowJar
        }
    }
    repositories {
        maven {
            name = "GitHubPackages"
            url = uri("https://maven.pkg.github.com/MCParks/ShowScript")
            credentials {
                username = project.findProperty("gpr.user") ?: System.getenv("USERNAME")
                password = project.findProperty("gpr.key") ?: System.getenv("TOKEN")
            }
        }
    }
}

